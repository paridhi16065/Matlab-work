a=imread('baboon256.tif');
figure, imshow(a)
v=input('enter a variance 0.05, 0.1 or 0.2 ');
an=imnoise(a,'gaussian',0,v);
[m,n]=size(an);
figure, imshow(uint8(an))
b=input('Enter Averaging Mask size 3, 5 or 7 ');
z=ones(b);
[p,q]=size(z);
if v==0.05
    if b==3 
        z=[0.000133 0.011256 0.000133; 0.011256 0.954445 0.011256; 0.000133 0.011256 0.000133];
    elseif b==5
        z=[0 0 0 0 0; 0 0.000133 0.011256 0.000133 0; 0 0.011256 0.954445 0.011256 0; 0 0.000133 0.011256 0.000133 0; 0 0 0 0 0];
    else
        z=[0 0 0 0 0 0 0; 0 0 0 0 0 0 0; 0 0 0.000133 0.011256 0.000133 0 0; 0 0 0.011256 0.954445 0.011256 0 0; 0 0 0.000133 0.011256 0.000133 0 0; 0 0 0 0 0 0 0; 0 0 0 0 0 0 0];

    end
elseif v==0.1
    if b==3
        z=[0.00285 0.047683 0.00285; 0.047683 0.797871 0.047683; 0.00285 0.047683 0.00285];
    elseif b==5
        z=[0 0 0 0 0; 0 0.00285 0.047683 0.00285 0; 0 0.047683 0.797871 0.047683 0;0 0.00285 0.047683 0.00285 0; 0 0 0 0 0];
    else
        z=[0 0 0 0 0 0 0; 0 0 0 0 0 0 0; 0 0 0.00285 0.047683 0.00285 0 0; 0 0 0.047683 0.797871 0.047683 0 0; 0 0 0.00285 0.047683 0.00285 0 0; 0 0 0 0 0 0 0; 0 0 0 0 0 0 0];
    end
else
    if b==3
        z=[0.01767 0.09759 0.01767; 0.09759 0.53891 0.09759; 0.01767 0.09759 0.01767];
    elseif b==5
        z=[0 0 0 0 0; 0 0.01767 0.09759 0.01767 0; 0 0.09759 0.53891 0.09759 0; 0 0.01767 0.09759 0.01767 0; 0 0 0 0 0];
    else
        z=[0 0 0 0 0 0 0; 0 0 0 0 0 0 0; 0 0 0.01767 0.09759 0.01767 0 0; 0 0 0.09759 0.53891 0.09759 0 0; 0 0 0.01767 0.09759 0.01767 0 0; 0 0 0 0 0 0 0; 0 0 0 0 0 0 0];
    end
end
    

w=1:p;
x=round(median(w));
anz=zeros(m+2*(x-1),n+2*(x-1));

for i=x:(m+(x-1))
    for j=x:(n+(x-1))
        anz(i,j)=an(i-(x-1),j-(x-1));
    end
end

sum=0;
x=0;
y=0;
for i=1:m
    for j=1:n
        for k=1:p
            for l=1:q 
                sum= sum+anz(i+x,j+y)*z(k,l);
                y=y+1;
            end
            y=0;
            x=x+1;
        end
        
        x=0;
        if v==0.05
            ans(i,j)=sum;
        elseif v==0.1
            ans(i,j)=sum/1.000003;
        else
            ans(i,j)=sum/0.999996;
        end
        sum=0;
    end
end
B=uint8(ans);
figure, imshow(B)
i=psnr(a,B)